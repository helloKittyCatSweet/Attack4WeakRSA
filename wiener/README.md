# Wiener Attack and Improvements on RSA

ç»´çº³æ”»å‡»åŠå…¶æ”¹è¿›ç‰ˆæœ¬çš„Pythonå®ç°

## ğŸ“– æ¦‚è¿°

æœ¬é¡¹ç›®å®ç°äº†é’ˆå¯¹å°ç§é’¥RSAçš„ä¸‰ç§æ”»å‡»æ–¹æ³•ï¼š

1. **Wieneræ”»å‡» (1990)** - åŸå§‹ç»´çº³æ”»å‡»
2. **Bunder-Tonienæ”»å‡» (2017)** - æ”¹è¿›çš„ç»´çº³æ”»å‡»
3. **æ–°è¾¹ç•Œæ”»å‡» (2023)** - åŸºäºæœ€æ–°è®ºæ–‡çš„è¿›ä¸€æ­¥æ”¹è¿›

åŸºäºè®ºæ–‡ï¼š**"A New Boundary of Minimum Private Key on Wiener Attack Against RSA Algorithm"** (IEEE 2023)

## ğŸ¯ æ ¸å¿ƒåŸç†

### RSAå®‰å…¨æ€§ä¸ç§é’¥å¤§å°

RSAçš„å®‰å…¨æ€§ä¾èµ–äºç§é’¥ `d` çš„å¤§å°ã€‚å¦‚æœ `d` è¿‡å°ï¼Œå¯ä»¥é€šè¿‡è¿åˆ†æ•°æ–¹æ³•æ¢å¤ç§é’¥ã€‚

### ä¸‰ç§æ”»å‡»æ–¹æ³•çš„è¾¹ç•Œæ¡ä»¶

| æ”»å‡»æ–¹æ³• | å¹´ä»½ | è¾¹ç•Œæ¡ä»¶ | å…¬å¼ |
|---------|------|---------|------|
| **Wiener** | 1990 | d < N^0.25 / 3 | çº¦ N^0.25 |
| **Bunder-Tonien** | 2017 | d < 2âˆš(2N) | çº¦ 2.828âˆšN |
| **æ–°è¾¹ç•Œ** | 2023 | d < âˆš(8.24264N) | çº¦ 2.871âˆšN |

### æ•°å­¦åŸºç¡€

**è¿åˆ†æ•°å±•å¼€**ï¼š
- è®¡ç®— e/N çš„è¿åˆ†æ•°æ”¶æ•›é¡¹ k/d
- å¦‚æœ d è¶³å¤Ÿå°ï¼Œk/d ä¼šéå¸¸æ¥è¿‘ e/N
- é€šè¿‡éªŒè¯ ed â‰¡ 1 (mod Ï†(N)) æ¥ç¡®è®¤å€™é€‰ç§é’¥

**æ–°è¾¹ç•Œæ¨å¯¼** (è®ºæ–‡ Lemma 3.1)ï¼š
```
Î± = 8 + 6âˆš2 â‰ˆ 16.4853
d < (Î±/2) Ã— âˆšN â‰ˆ âˆš(8.24264N)
```

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
wiener/
â”œâ”€â”€ main.py                      # ä¸»æ¼”ç¤ºç¨‹åº
â”œâ”€â”€ config.py                    # é…ç½®å‚æ•°
â”œâ”€â”€ continued_fraction.py        # è¿åˆ†æ•°ç®—æ³•
â”œâ”€â”€ rsa_weak_key_generator.py    # å¼±RSAå¯†é’¥ç”Ÿæˆå™¨
â”œâ”€â”€ wiener_attack.py             # ä¸‰ç§æ”»å‡»æ–¹æ³•å®ç°
â””â”€â”€ README.md                    # æœ¬æ–‡ä»¶
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ä¾èµ–å®‰è£…

```bash
pip install pycryptodome
```

### åŸºæœ¬ä½¿ç”¨

#### 1. è¿è¡Œå•æ¬¡æ”»å‡»æ¼”ç¤º

```bash
# ä½¿ç”¨æ–°è¾¹ç•Œæ”»å‡»ï¼ˆé»˜è®¤ï¼‰
python main.py --mode single --bits 1024 --attack new_boundary

# ä½¿ç”¨Wieneræ”»å‡»
python main.py --mode single --bits 1024 --attack wiener

# ä½¿ç”¨Bunder-Tonienæ”»å‡»
python main.py --mode single --bits 1024 --attack bunder_tonien
```

#### 2. è¿è¡Œä¸‰ç§æ–¹æ³•å¯¹æ¯”

```bash
python main.py --mode compare --bits 1024
```

#### 3. è¿è¡ŒåŸºå‡†æµ‹è¯•ï¼ˆå¤ç°è®ºæ–‡ç»“æœï¼‰

```bash
python main.py --mode benchmark
```

è®ºæ–‡ä¸­çš„å‚è€ƒå€¼ï¼ˆIntel i5-8265U + 4GB RAMï¼‰ï¼š
- 1024-bit: 0.052s
- 2048-bit: 0.152s
- 4096-bit: 0.75s
- 8192-bit: 4.42s

#### 4. è¿è¡Œè¾¹ç•Œæµ‹è¯•

```bash
python main.py --mode boundary --bits 1024 --tests 5
```

## ğŸ“Š ç¤ºä¾‹è¾“å‡º

### å•æ¬¡æ”»å‡»æ¼”ç¤º

```
======================================================================
ç»´çº³æ”»å‡»æ¼”ç¤º - NEW_BOUNDARY
======================================================================

[1] ç”Ÿæˆ 1024-bit å¼±RSAå¯†é’¥...
  N æ¯”ç‰¹é•¿åº¦: 1024
  d æ¯”ç‰¹é•¿åº¦: 520
  ç†è®ºè¾¹ç•Œ: 2.87e+154
  d < è¾¹ç•Œ: âœ“

[2] æ£€æŸ¥å¯†é’¥è„†å¼±æ€§...
  Wieneræ”»å‡»:
    è¾¹ç•Œ: 1.68e+77
    è„†å¼±: âœ—
  
  Bunder-Tonienæ”»å‡»:
    è¾¹ç•Œ: 2.83e+154
    è„†å¼±: âœ“
  
  æ–°è¾¹ç•Œæ”»å‡»:
    è¾¹ç•Œ: 2.87e+154
    è„†å¼±: âœ“

[3] æ‰§è¡Œ new_boundary æ”»å‡»...

[4] éªŒè¯æ”»å‡»ç»“æœ...
  âœ“ æ”»å‡»æˆåŠŸ!
  åŸå§‹ç§é’¥ d: 123456...
  æ¢å¤ç§é’¥ d: 123456...
  åŒ¹é…: âœ“
  è€—æ—¶: 0.152 ms

[5] åŠ å¯†è§£å¯†æµ‹è¯•...
  åŸå§‹æ¶ˆæ¯: 123456789
  å¯†æ–‡: 987654...
  è§£å¯†æˆåŠŸ: âœ“
```

### ä¸‰ç§æ–¹æ³•å¯¹æ¯”

```
======================================================================
ä¸‰ç§æ”»å‡»æ–¹æ³•å¯¹æ¯” - 1024-bit RSA
======================================================================

[2] ç†è®ºè¾¹ç•Œå¯¹æ¯”...

  Wiener (1990): N^0.25 / 3
    è¾¹ç•Œå€¼: 1.68e+77
    æ¯”ç‰¹é•¿åº¦: 256

  Bunder-Tonien (2017): 2*sqrt(2*N)
    è¾¹ç•Œå€¼: 2.83e+154
    æ¯”ç‰¹é•¿åº¦: 513
    ç›¸å¯¹Wieneræå‡: 1.68e+77x

  æ–°è¾¹ç•Œ (2023): sqrt(8.24264*N)
    è¾¹ç•Œå€¼: 2.87e+154
    æ¯”ç‰¹é•¿åº¦: 513
    ç›¸å¯¹Wieneræå‡: 1.71e+77x
    ç›¸å¯¹Bunder-Tonienæå‡: 1.01x

[4] æ‰§è¡Œæ‰€æœ‰æ”»å‡»æ–¹æ³•...

æ–¹æ³•                  æˆåŠŸ        è€—æ—¶(ms)         åŒ¹é…      
----------------------------------------------------------------------
wiener              âœ—          0.145           âœ—         
bunder_tonien       âœ“          0.148           âœ“         
new_boundary        âœ“          0.150           âœ“         
```

## ğŸ”§ æ¨¡å—è¯´æ˜

### 1. continued_fraction.py

å®ç°è¿åˆ†æ•°ç®—æ³•ï¼š
- `compute_convergents(e, n)` - è®¡ç®— e/n çš„è¿åˆ†æ•°æ”¶æ•›é¡¹
- `rational_to_contfrac(x, y)` - æœ‰ç†æ•°è½¬è¿åˆ†æ•°
- `contfrac_to_rational(coefficients)` - è¿åˆ†æ•°è½¬æœ‰ç†æ•°

### 2. rsa_weak_key_generator.py

ç”Ÿæˆæ˜“å—æ”»å‡»çš„å¼±RSAå¯†é’¥ï¼š
- `generate_weak_rsa(bits, d_ratio)` - ç”ŸæˆæŒ‡å®šdæ¯”ä¾‹çš„å¼±å¯†é’¥
- `generate_by_boundary(bits, attack_type)` - æ ¹æ®æ”»å‡»ç±»å‹ç”Ÿæˆå¯†é’¥
- `check_vulnerability(n, d)` - æ£€æŸ¥å¯†é’¥è„†å¼±æ€§

### 3. wiener_attack.py

å®ç°ä¸‰ç§æ”»å‡»æ–¹æ³•ï¼š
- `WienerAttack` - åŸå§‹Wieneræ”»å‡» (d < N^0.25 / 3)
- `BunderTonienAttack` - Bunder-Tonienæ”»å‡» (d < 2âˆš(2N))
- `NewBoundaryAttack` - æ–°è¾¹ç•Œæ”»å‡» (d < âˆš(8.24264N))
- `AttackComparison` - æ”»å‡»æ–¹æ³•å¯¹æ¯”å·¥å…·

### 4. main.py

ä¸»æ¼”ç¤ºç¨‹åºï¼Œæä¾›å››ç§è¿è¡Œæ¨¡å¼ï¼š
- `single` - å•æ¬¡æ”»å‡»æ¼”ç¤º
- `compare` - ä¸‰ç§æ–¹æ³•å¯¹æ¯”
- `benchmark` - åŸºå‡†æµ‹è¯•
- `boundary` - è¾¹ç•Œæµ‹è¯•

## ğŸ“ˆ æ€§èƒ½åˆ†æ

### æ—¶é—´å¤æ‚åº¦

æ‰€æœ‰ä¸‰ç§æ”»å‡»æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦å‡ä¸º **O(log N)**ï¼Œä¸»è¦æ¥è‡ªï¼š
1. è¿åˆ†æ•°å±•å¼€ï¼ˆæ¬§å‡ é‡Œå¾—ç®—æ³•ï¼‰
2. æ”¶æ•›é¡¹éªŒè¯

### å®éªŒç»“æœ

åœ¨ç°ä»£è®¡ç®—æœºä¸Šï¼ˆç¤ºä¾‹é…ç½®ï¼‰ï¼š

| RSAä½é•¿ | å¹³å‡è€—æ—¶ |
|---------|---------|
| 512     | ~0.02s  |
| 1024    | ~0.05s  |
| 2048    | ~0.15s  |
| 4096    | ~0.75s  |
| 8192    | ~4.5s   |

## ğŸ” å®‰å…¨å»ºè®®

### å¦‚ä½•é˜²å¾¡Wieneræ”»å‡»

1. **ä½¿ç”¨è¶³å¤Ÿå¤§çš„ç§é’¥**
   - ç¡®ä¿ d > N^0.5
   - éµå¾ªNIST SP 800-56Bæ ‡å‡†

2. **å¯†é’¥ç”Ÿæˆè§„èŒƒ**
   - ä½¿ç”¨æ ‡å‡†çš„RSAå¯†é’¥ç”Ÿæˆç®—æ³•
   - ä¸è¦äººä¸ºé€‰æ‹©å°çš„ç§é’¥

3. **æ¨èå‚æ•°**
   - RSAæ¨¡æ•°ï¼šâ‰¥ 2048ä½
   - å…¬é’¥æŒ‡æ•°ï¼še = 65537ï¼ˆå¸¸ç”¨å€¼ï¼‰
   - ç§é’¥ï¼šéšæœºç”Ÿæˆï¼Œä¸æ–½åŠ å¤§å°é™åˆ¶

### è„†å¼±é…ç½®ç¤ºä¾‹

âŒ **ä¸å®‰å…¨**ï¼š
```python
# äººä¸ºé€‰æ‹©å°çš„d
d = 12345
e = inverse(d, phi)  # å±é™©ï¼
```

âœ… **å®‰å…¨**ï¼š
```python
# æ ‡å‡†æ–¹æ³•
e = 65537
d = inverse(e, phi)  # å®‰å…¨
```

## ğŸ“š å‚è€ƒæ–‡çŒ®

1. **Wiener, M. J.** (1990). "Cryptanalysis of short RSA secret exponents." *IEEE Transactions on Information Theory*, 36(3), 553-558.

2. **Bunder, M., & Tonien, J.** (2017). "A new attack on the RSA cryptosystem based on continued fractions." *Malaysian Journal of Mathematical Sciences*, 11, 45-57.

3. **è®ºæ–‡** (2023). "A New Boundary of Minimum Private Key on Wiener Attack Against RSA Algorithm." *IEEE International Conference on Cryptography and Network Security*.

4. **Boneh, D., & Durfee, G.** (2000). "Cryptanalysis of RSA with private key d < N^0.292." *IEEE Transactions on Information Theory*, 46(4), 1339-1349.

5. **BlÃ¶mer, J., & May, A.** (2004). "A generalized Wiener attack on RSA." *PKC 2004*, LNCS 2947, 1-13.

## ğŸ“ æ•™è‚²ç”¨é€”

æœ¬é¡¹ç›®ä»…ç”¨äºï¼š
- âœ… å¯†ç å­¦æ•™å­¦å’Œç ”ç©¶
- âœ… å®‰å…¨æ€§åˆ†æå’Œæµ‹è¯•
- âœ… å­¦æœ¯è®ºæ–‡å¤ç°

**è­¦å‘Š**ï¼šè¯·å‹¿ç”¨äºéæ³•ç›®çš„ï¼

## ğŸ“ è®¸å¯è¯

æœ¬é¡¹ç›®ä¸ºNTUå¯†ç å­¦è¯¾ç¨‹ä½œä¸šï¼Œä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ã€‚

## ğŸ‘¥ è´¡çŒ®è€…

NTU SC6104 - Introduction to Cryptography

---

**æ³¨æ„**ï¼šæœ¬å®ç°å±•ç¤ºäº†RSAåœ¨å‚æ•°é€‰æ‹©ä¸å½“æ—¶çš„è„†å¼±æ€§ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¯·å§‹ç»ˆä½¿ç”¨ç»è¿‡éªŒè¯çš„å¯†ç å­¦åº“å’Œæ ‡å‡†å¯†é’¥ç”Ÿæˆæ–¹æ³•ï¼

